Traceback (most recent call last):
  File "training.py", line 207, in <module>
    main()
  File "training.py", line 179, in main
    device=device
UnboundLocalError: local variable 'device' referenced before assignment